# 墙壁涂色问题

## 一、题目描述

给一个环形的墙壁涂颜色，颜色一共有 k 种，墙壁被竖直地划分成 n 个部分，相邻的部分颜色不能相同。请你写程序计算出一共有多少种给墙壁上色的方案？



## 二、分析

这是一道使用递推求解的问题，也可以看作是简单线性DP类型的问题。

解决递推与动态规划问题，首先要**进行状态定义，给出状态的数学表示与含义的文字描述。**

关于**如何给出状态定义，比较明显的，当前位置/长度等，还有题目中给出的有数量的量，以及思路中涉及到的会影响结果的位置，量等，这些可以用来构成状态**。(有时一些难以分析的点可以升级对状态的描述，一般是具体到位置的。)



## 三、解法

### 1.方法一：环形问题，非环思考

墙壁图色问题要求首尾墙壁的颜色不一样，因此，可以设状态为$f(n,i,j)$，表示一共n块墙壁，第一块墙壁涂i，最后一块墙壁涂j的上色方案个数。

由此，可以得到递推方程：
$$
f(n,i,j)=\sum f(n-1,i,k) (k\neq j)
$$
这个递推方程的含义：表示一共n块墙壁，第一块墙壁涂i，最后一块墙壁涂j的上色方案个数，等于n-1块墙壁，第一块墙壁涂i，最后一块墙壁涂不是j的所有方法个数之和。



## 2 .方法二：使用隐变量

由于第一块的颜色涂i还是涂m，方案数一样，因此，隐藏第一块的颜色，令状态为$f(n,j)$表示，第一块为第1种颜色，最后一块为j的方法个数，由此可以得到递推方程：
$$
f(n,j)=\sum f(n-1)(k)(k!=j)
$$
那么最终的答案就是
$$
ans=(\sum f(n,j)(j!=1))*k
$$


### 3.方法三：降维

定义状态$f(n)$为首尾颜色不同的方案总数。

由于第1块和第n块颜色不一样，考虑第(n-1) 块的颜色，如果第(n-1)块的颜色与第1块颜色不同，那么第n块有(k-2)种颜色的涂法，如果第(n-1)块的颜色与第1块颜色相同，那么第n块有(k-1)种涂法，由于第1,(n-1)块颜色相同，那么第(n-2) 块就和第1块颜色不同，由此可以得到递推方程：
$$
f(n)=f(n-1)*(k-2)+f(n-2)*(k-1)
$$
