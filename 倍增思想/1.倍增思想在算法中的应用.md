# 倍增思想在算法中的应用

倍增法，按照字面意思来看就是某样东西翻倍增长，比较典型的例子有快速幂，RMQ问题，求LCA等。

**使用倍增思想，通常会使得一些题目的时间复杂度降低到$O(\log{n})$**。



## 一、应用倍增法思想的一道典型题目

### 题目描述

给出一个长度为n的环和一个常数k，每次会从第i个点跳到第$(i + k) \mod n + 1$个点，总共跳了m次。每个点都有一个权值，求m次跳跃的起点的权值之和对$10^9+7$取模的结果。

数据范围：$1 \le n \le 10^6, 1 \le m \le 10^{18}, 1 \le k \le n, 0 \le a_i \le 10^9$。



### 分析

因为**m的数据范围太大，不能用暴力求解，而这种次数范围超大的求和或者其他问题，可以考虑使用倍增法，通过计算跳1,2,4,8一直到$2^p$次可以获得的权值之和来降低时间复杂度。**这个就是利用了所有数字都可以表示成二进制形式，进而方便进行计算。

可以定义$go[i][x]$表示第x个点跳$2^i$步之后的终点，而$sum[i][x]$表示第x个点跳$2^i$步之后能获得点权和。预处理时，对于跳$2^i$步的信息，我们可以看作是先跳了$2^{i-1}$步，再跳$2^{i-1}$，因为显然有$2^{i-1}+2^{i-1}=2^i$，即有$sum[i][x] = sum[i - 1][x] + sum[i - 1][go[i - 1][x]]$，且$go[i][x] = go[i-1][go[i-1][x]]$。

**实现需要注意的细节：**为了保证统计的时候不重不漏，我们一般预处理出**“左闭右开”的点权和**。即对于跳1步的情况，我们只记录该点的点权和，对于跳2步的情况，我们只记录该点及其下一个点的点权和，**相当于总是不将终点的点权和计入sum。**

